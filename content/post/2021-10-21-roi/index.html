---
title: ROI
author: Miguel Conde
date: '2021-10-21'
slug: []
categories:
  - R
  - paquetes
  - optimización
tags:
  - ''
description: 'Una infraestructura de optimización en R'
thumbnail: ''
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<div id="intro" class="section level1">
<h1>Intro</h1>
<p>ROI = <em>R Optimization Infrastructure</em></p>
<p><small>
- Infraestructura ampliable para modelado de problemas de optimización (lineal,
cuadrática, cónica y no lineal general).
- Administra múltiples <em>solvers</em>, reformulaciones, colecciones de problemas y
funciones para leer y escribir problemas de optimización en varios formatos.
</small></p>
<p><a href="https:/epub.wu.ac.at/5858/"><em>Paper</em> de 2019</a> muy recomendable:</p>
<p><small>
- Apartado 2: resumen de teoría de optimización
- Apartado 3: panorámica del software de optimización disponible en R
- Apartados 4 y 5: Descripción de la infraestructura y la librería
- Apartado 6: Ejemplos
</small></p>
<br><br>
<center>
<strong>ROI</strong> es a optimización lo que <em>caret</em> a <em>machine learning</em>.
</center>
</div>
<div id="ejemplo" class="section level1">
<h1>Ejemplo</h1>
<div id="definir-el-problema" class="section level2">
<h2>Definir el problema</h2>
<center>
<img src="images/lp.png" width="50%" style="display: block; margin: auto;" />
</center>
<pre class="r"><code>library(ROI)
library(tidyverse)

A &lt;- rbind(c(5, 7, 2), c(3, 2, -9), c(1, 3, 1))
dir &lt;- c(&quot;&lt;=&quot;, &quot;&lt;=&quot;, &quot;&lt;=&quot;)
rhs &lt;- c(61, 35, 31)

lp &lt;- OP(objective   = L_objective(c(3, 7, -12)),
         constraints = L_constraint(A, dir = dir, rhs = rhs),
         types       = NULL, # NULL =&quot;C&quot;, &quot;I&quot;, &quot;B&quot;
         bounds      = V_bound(li = 3, ui = 3, lb = -10, ub = 10, nobj = 3),
         maximum     = TRUE)</code></pre>
</div>
<div id="definición-alternativa" class="section level2">
<h2>Definición alternativa</h2>
<pre class="r"><code># ALTERNATIVA:

lp &lt;- OP()

objective(lp)   &lt;- L_objective(c(3, 7, -12)) # 3x_1 + 7x_2 -12x_3
constraints(lp) &lt;- L_constraint(A, dir = c(&quot;&lt;=&quot;, &quot;&lt;=&quot;, &quot;&lt;=&quot;), rhs = rhs)
bounds(lp)      &lt;- V_bound(li = 3, ui = 3, lb = -10, ub = 10, nobj = 3)
# types(lp)
maximum(lp)     &lt;- TRUE

lp</code></pre>
<pre><code>## ROI Optimization Problem:
## 
## Maximize a linear objective function of length 3 with
## - 3 continuous objective variables,
## 
## subject to
## - 3 constraints of type linear.
## - 1 lower and 1 upper non-standard variable bound.</code></pre>
</div>
<div id="solvers-disponibles" class="section level2">
<h2><em>Solvers</em> disponibles</h2>
<ul>
<li>Para <strong><em>este</em></strong> problema, la infraestructura ROI tiene disponibles los
siguientes <em>solvers</em>:</li>
</ul>
<pre class="r"><code>ROI_available_solvers(lp)[, c(&quot;Package&quot;, &quot;Repository&quot;)] %&gt;% head()</code></pre>
<pre><code>##              Package                 Repository
## 1 ROI.plugin.alabama https://CRAN.R-project.org
## 2     ROI.plugin.clp https://CRAN.R-project.org
## 3   ROI.plugin.cplex https://CRAN.R-project.org
## 5    ROI.plugin.ecos https://CRAN.R-project.org
## 6    ROI.plugin.glpk https://CRAN.R-project.org
## 7 ROI.plugin.lpsolve https://CRAN.R-project.org</code></pre>
</div>
<div id="solvers-instalados" class="section level2">
<h2><em>Solvers</em> instalados</h2>
<pre class="r"><code>ROI_installed_solvers()</code></pre>
<pre><code>##                nlminb               alabama               deoptim 
##   &quot;ROI.plugin.nlminb&quot;  &quot;ROI.plugin.alabama&quot;  &quot;ROI.plugin.deoptim&quot; 
##                  glpk               lpsolve                nloptr 
##     &quot;ROI.plugin.glpk&quot;  &quot;ROI.plugin.lpsolve&quot;   &quot;ROI.plugin.nloptr&quot; 
##              quadprog 
## &quot;ROI.plugin.quadprog&quot;</code></pre>
<p>Si el que necesitas no está:</p>
<pre><code>install.packages(&quot;ROI.plugin.glpk&quot;)</code></pre>
</div>
<div id="solvers-registrados" class="section level2">
<h2><em>Solvers</em> registrados</h2>
<pre class="r"><code>ROI_registered_solvers() %&gt;% head(15)</code></pre>
<pre><code>##               nlminb              alabama             deoptimr 
##  &quot;ROI.plugin.nlminb&quot; &quot;ROI.plugin.alabama&quot; &quot;ROI.plugin.deoptim&quot; 
##              deoptim                 glpk              lpsolve 
## &quot;ROI.plugin.deoptim&quot;    &quot;ROI.plugin.glpk&quot; &quot;ROI.plugin.lpsolve&quot; 
##        nloptr.bobyqa        nloptr.crs2lm        nloptr.direct 
##  &quot;ROI.plugin.nloptr&quot;  &quot;ROI.plugin.nloptr&quot;  &quot;ROI.plugin.nloptr&quot; 
##       nloptr.directL         nloptr.lbfgs    nloptr.neldermead 
##  &quot;ROI.plugin.nloptr&quot;  &quot;ROI.plugin.nloptr&quot;  &quot;ROI.plugin.nloptr&quot; 
##        nloptr.newuoa         nloptr.sbplx         nloptr.stogo 
##  &quot;ROI.plugin.nloptr&quot;  &quot;ROI.plugin.nloptr&quot;  &quot;ROI.plugin.nloptr&quot;</code></pre>
<p>Para registrarlo la primera vez que lo usas:</p>
<pre><code>library(&quot;ROI.plugin.glpk&quot;)</code></pre>
</div>
<div id="resolver-el-problema" class="section level2">
<h2>Resolver el problema</h2>
<pre class="r"><code>ROI_applicable_solvers(lp)</code></pre>
<pre><code>## [1] &quot;alabama&quot;       &quot;glpk&quot;          &quot;lpsolve&quot;       &quot;nloptr.cobyla&quot;
## [5] &quot;nloptr.mma&quot;    &quot;nloptr.auglag&quot; &quot;nloptr.isres&quot;  &quot;nloptr.slsqp&quot;</code></pre>
<pre class="r"><code>(lp_sol &lt;- ROI_solve(lp, solver = &quot;glpk&quot;))</code></pre>
<pre><code>## Optimal solution found.
## The objective value is: 8.670149e+01</code></pre>
</div>
<div id="resultados" class="section level2">
<h2>Resultados</h2>
<pre class="r"><code>solution(lp_sol)</code></pre>
<pre><code>## [1]  0.000000  9.238806 -1.835821</code></pre>
<pre class="r"><code>objective(lp)(solution(lp_sol))</code></pre>
<pre><code>## [1] 86.70149</code></pre>
</div>
<div id="resultados-1" class="section level2">
<h2>Resultados</h2>
<pre class="r"><code>lp_sol$status</code></pre>
<pre><code>## $code
## [1] 0
## 
## $msg
##   solver glpk
##     code 5
##   symbol GLP_OPT
##  message Solution is optimal.
## roi_code 0</code></pre>
</div>
<div id="resultados-2" class="section level2">
<h2>Resultados</h2>
<pre class="r"><code>lp_sol$message</code></pre>
<pre><code>## $optimum
## [1] 86.70149
## 
## $solution
## [1]  0.000000  9.238806 -1.835821
## 
## $status
## [1] 5
## 
## $solution_dual
## [1] -4.298507  0.000000  0.000000
## 
## $auxiliary
## $auxiliary$primal
## [1] 61.0000 35.0000 25.8806
## 
## $auxiliary$dual
## [1] 0.5820896 1.4626866 0.0000000
## 
## 
## $sensitivity_report
## [1] NA</code></pre>
</div>
</div>
<div id="referencias-y-recursos" class="section level1">
<h1>Referencias y Recursos</h1>
<ul>
<li><a href="https:/roi.r-forge.r-project.org/">ROI homepage</a></li>
<li><a href="https:/cran.r-project.org/web/packages/ROI/index.html">ROI en CRAN</a></li>
</ul>
</div>
